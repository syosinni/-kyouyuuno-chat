<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>è²¿æ˜“ã‚·ã‚¹ãƒ†ãƒ </title>
  <style>
    body { font-family:sans-serif; padding:10px; }
    #countryList, #tradeList { margin:10px 0; padding:5px; background:#f8f8f8; border:1px solid #ccc; }
    input, select, button { margin:5px; padding:5px; }
  </style>
</head>
<body>
  <h1>ğŸŒ è²¿æ˜“ã‚·ã‚¹ãƒ†ãƒ </h1>

  <h2>å›½ã®ç®¡ç†</h2>
  <input type="text" id="countryName" placeholder="å›½å">
  <input type="number" id="iron" placeholder="é‰„" value="100">
  <input type="number" id="oil" placeholder="çŸ³æ²¹" value="100">
  <input type="number" id="food" placeholder="é£Ÿæ–™" value="100">
  <button onclick="addCountry()">å›½ã‚’è¿½åŠ </button>
  <div id="countryList"></div>

  <h2>è²¿æ˜“äº¤æ¸‰</h2>
  è¼¸å‡ºå›½:
  <select id="exporter"></select>
  è¼¸å…¥å›½:
  <select id="importer"></select>
  è³‡æº:
  <select id="resource">
    <option value="iron">é‰„</option>
    <option value="oil">çŸ³æ²¹</option>
    <option value="food">é£Ÿæ–™</option>
  </select>
  æ•°é‡: <input type="number" id="amount" value="10">
  <button onclick="addTrade()">è²¿æ˜“ã‚’è¨­å®š</button>
  <div id="tradeList"></div>

  <h2>å¹´é€²è¡Œ</h2>
  <button onclick="progressYear()">1å¹´é€²è¡Œ</button>
  <p id="log"></p>

  <script>
    let countries = [];
    let trades = [];
    let year = 1961;

    function addCountry(){
      const name=document.getElementById("countryName").value;
      const iron=parseInt(document.getElementById("iron").value)||0;
      const oil=parseInt(document.getElementById("oil").value)||0;
      const food=parseInt(document.getElementById("food").value)||0;
      if(!name)return;
      countries.push({name, iron, oil, food});
      updateCountryList();
      updateCountrySelect();
    }

    function updateCountryList(){
      document.getElementById("countryList").innerHTML = countries.map(c=>
        `<div><b>${c.name}</b> é‰„:${c.iron} çŸ³æ²¹:${c.oil} é£Ÿæ–™:${c.food}</div>`
      ).join("");
    }

    function updateCountrySelect(){
      const opts=countries.map(c=>`<option value="${c.name}">${c.name}</option>`).join("");
      document.getElementById("exporter").innerHTML=opts;
      document.getElementById("importer").innerHTML=opts;
    }

    function addTrade(){
      const exp=document.getElementById("exporter").value;
      const imp=document.getElementById("importer").value;
      const res=document.getElementById("resource").value;
      const amt=parseInt(document.getElementById("amount").value)||0;
      if(exp==imp||amt<=0)return alert("ç„¡åŠ¹ãªè²¿æ˜“è¨­å®š");
      trades.push({exporter:exp, importer:imp, resource:res, amount:amt});
      updateTradeList();
    }

    function updateTradeList(){
      document.getElementById("tradeList").innerHTML = trades.map(t=>
        `<div>${t.exporter} â†’ ${t.importer} : ${t.resource} ${t.amount}</div>`
      ).join("");
    }

    function progressYear(){
      let log=`${year}å¹´ã®è²¿æ˜“çµæœ:\n`;
      trades.forEach(t=>{
        const exp=countries.find(c=>c.name==t.exporter);
        const imp=countries.find(c=>c.name==t.importer);
        if(exp && imp && exp[t.resource]>=t.amount){
          exp[t.resource]-=t.amount;
          imp[t.resource]+=t.amount;
          log+=`${t.exporter} â†’ ${t.importer} : ${t.resource} ${t.amount}\n`;
        } else {
          log+=`${t.exporter}ã®è³‡æºä¸è¶³ã§å¤±æ•—\n`;
        }
      });
      document.getElementById("log").textContent=log;
      year++;
      updateCountryList();
    }
  </script>
</body>
</html>
