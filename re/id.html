<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>国家運営シミュレーション</title>
<style>
  body { display:flex; font-family: sans-serif; margin:0; height:100vh; }
  #map-container { flex:3; border:1px solid #333; }
  #panel { flex:1; padding:10px; background:#f0f0f0; overflow:auto; }
  .territory { cursor:pointer; stroke:#000; fill:#ccc; }
  button { margin:5px 0; padding:5px 10px; }
</style>
</head>
<body>
  <div id="map-container">
    <svg id="svg-map" viewBox="0 0 500 500" width="100%" height="100%">
      <rect id="territory1" class="territory" x="10" y="10" width="200" height="200"/>
      <rect id="territory2" class="territory" x="220" y="10" width="200" height="200"/>
      <rect id="territory3" class="territory" x="10" y="220" width="200" height="200"/>
      <rect id="territory4" class="territory" x="220" y="220" width="200" height="200"/>
    </svg>
  </div>
  <div id="panel">
    <h2>国家情報</h2>
    <div id="country-info">
      <p>国名: <span id="country-name">帝国</span></p>
      <p>代表: <span id="country-leader">未設定</span></p>
      <p>主義: <span id="country-ideology">君主制</span></p>
      <p>人口: <span id="country-population">1000000</span></p>
      <p>予算: <span id="country-budget">500000</span></p>
      <p>通貨: <span id="country-currency">10000</span></p>
    </div>
    <h3>操作</h3>
    <button onclick="saveGame()">セーブ</button>
    <button onclick="loadGame()">ロード</button>
    <hr>
    <h3>選択中領土</h3>
    <p id="selected-territory">なし</p>
  </div>

<script>
let country = {
  name: "帝国",
  leader: "未設定",
  ideology: "君主制",
  population: 1000000,
  budget: 500000,
  currency: 10000,
  territories: {}
};

let selectedTerritory = null;

// SVG領土クリック設定
document.querySelectorAll('.territory').forEach(t => {
  t.addEventListener('click', () => selectTerritory(t));
});

function selectTerritory(territory) {
  selectedTerritory = territory.id;
  document.getElementById('selected-territory').innerText = selectedTerritory;
  // 自国色に変更
  territory.style.fill = '#8888ff';
  // 国家データに追加
  country.territories[selectedTerritory] = { resources: 100, units: [] };
  updatePanel();
}

function updatePanel() {
  document.getElementById('country-name').innerText = country.name;
  document.getElementById('country-leader').innerText = country.leader;
  document.getElementById('country-ideology').innerText = country.ideology;
  document.getElementById('country-population').innerText = country.population;
  document.getElementById('country-budget').innerText = country.budget;
  document.getElementById('country-currency').innerText = country.currency;
}

// セーブ
function saveGame() {
  const dataStr = JSON.stringify(country, null, 2);
  const blob = new Blob([dataStr], {type: "application/json"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = "data.json";
  a.click();
  URL.revokeObjectURL(url);
}

// ロード
function loadGame() {
  const input = document.createElement('input');
  input.type = 'file';
  input.accept = '.json';
  input.onchange = e => {
    const file = e.target.files[0];
    const reader = new FileReader();
    reader.onload = event => {
      country = JSON.parse(event.target.result);
      restoreTerritories();
      updatePanel();
    };
    reader.readAsText(file);
  };
  input.click();
}

// 領土復元
function restoreTerritories() {
  document.querySelectorAll('.territory').forEach(t => {
    if(country.territories[t.id]) {
      t.style.fill = '#8888ff';
    } else {
      t.style.fill = '#ccc';
    }
  });
}

updatePanel();
</script>
</body>
</html>
