<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>学習支援サービス</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #fff;
      color: #333;
      transition: all 0.5s ease;
    }
    header {
      background: #4CAF50;
      color: white;
      padding: 10px;
      text-align: center;
    }
    .bank-mode {
      background: #0a0a0a !important;
      color: #00ff99 !important;
      font-family: "Courier New", monospace;
    }
    .hidden { display: none; }

    #loading-screen {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: #000;
      color: #00ff99;
      font-family: "Courier New", monospace;
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      font-size: 18px;
      line-height: 2em;
      z-index: 1000;
    }
    .news-item {
      border-bottom: 1px solid #444;
      padding: 8px;
      cursor: pointer;
    }
    .news-item:hover { background: rgba(0,255,150,0.1); }

    /* 詳細表示用モーダル */
    #modal {
      position: fixed;
      top:0; left:0; right:0; bottom:0;
      background: rgba(0,0,0,0.85);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 2000;
    }
    #modal-content {
      background: #111;
      color: #0f0;
      padding: 20px;
      border-radius: 8px;
      max-width: 500px;
      text-align: center;
    }
    #modal button {
      margin-top: 10px;
      padding: 6px 12px;
      background: #0f0;
      color: #000;
      border: none;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <!-- 学習モード -->
  <header id="header">中1学習支援サービス</header>
  <div id="content">
    <h2>今日の勉強サポート</h2>
    <p>ここでは中学1年生の学習に役立つ情報を提供します。</p>
    <input type="text" id="search" placeholder="キーワード検索">
    <button onclick="checkSearch()">検索</button>
  </div>

  <!-- 認証演出 -->
  <div id="loading-screen"></div>

  <!-- 詳細モーダル -->
  <div id="modal" onclick="closeModal()">
    <div id="modal-content"></div>
  </div>

  <script>
    const body = document.body;
    const content = document.getElementById("content");
    const header = document.getElementById("header");
    const loadingScreen = document.getElementById("loading-screen");
    const modal = document.getElementById("modal");
    const modalContent = document.getElementById("modal-content");

    // ハッシュ関数（Web Crypto API使用）
    async function sha256(str) {
      const buf = new TextEncoder().encode(str);
      const hash = await crypto.subtle.digest("SHA-256", buf);
      return Array.from(new Uint8Array(hash)).map(b => b.toString(16).padStart(2,"0")).join("");
    }

    // 正しいハッシュ（事前計算しておく）
    const codes = {
      "rengouinfo": "情報銀行",
      "vipaccess": "VIP情報銀行"
    };
    let hashedCodes = {};

    // 初期化（平文は捨ててハッシュだけ保持）
    (async ()=>{
      for (let key in codes) {
        hashedCodes[await sha256(key)] = codes[key];
      }
    })();

    // 検索チェック
    async function checkSearch() {
      const val = document.getElementById("search").value.trim();
      const hash = await sha256(val);
      if (hashedCodes[hash]) {
        playAuthAnimation(() => activateMode(hashedCodes[hash]));
      } else {
        alert("検索結果なし");
      }
    }

    // 認証演出
    function playAuthAnimation(callback) {
      content.classList.add("hidden");
      header.innerText = "";
      loadingScreen.style.display = "flex";

      const steps = [
        "サーバーの応答まち...",
        "＞f5.siの信号を検知...",
        "＞認証中...",
        "＞IPアドレス確認中...",
        "＞アクセス承認...",
        "💠 ようこそ 💠"
      ];
      let i = 0;
      loadingScreen.innerHTML = "";
      const interval = setInterval(() => {
        loadingScreen.innerHTML += steps[i] + "<br>";
        i++;
        if (i >= steps.length) {
          clearInterval(interval);
          setTimeout(() => {
            loadingScreen.style.display = "none";
            callback();
          }, 1000);
        }
      }, 1000);
    }

    // モード切替
    function activateMode(mode) {
      body.classList.add("bank-mode");
      header.innerText = mode;
      content.classList.remove("hidden");

      if (mode === "情報銀行") {
        renderNews([
          {title:"山の学校先生行動記録", detail:"連合情報部は今回、今までの連合設立から7年でこれは一番疲労が溜まる作戦だっただろう。1日目の夜10:25~4:12と2日目の10:19~10:225までの先生たちの行動記録。個人取引で得よう"},
          {title:"あなたは大丈夫？情報雨流失原因ランキング", detail:"第三位・公開市場での取引...続きは個人取引で"}
        ]);
      }
      if (mode === "VIP情報銀行") {
        renderNews([
          {title:"", detail:""},
          {title:"", detail:""}
        ]);
      }
    }

    // ニュース表示
    function renderNews(newsArray) {
      let html = "<h2>最近の情報</h2>";
      newsArray.forEach((n, i) => {
        html += `<div class="news-item" onclick="openModal('${n.title}','${n.detail}')">${n.title}</div>`;
      });
      html += `<p><a href="https://docs.google.com/document/d/1CySvUHVIL0Y61mJFlM_2BI6VL9i1Ukx2TJZiCh1R3so/edit?usp=sharing" target="_blank">個別取引はこちら</a></p>`;
      content.innerHTML = html;
    }

    // 詳細モーダル
    function openModal(title, detail) {
      modalContent.innerHTML = `<h3>${title}</h3><p>${detail}</p><button onclick="closeModal()">閉じる</button>`;
      modal.style.display = "flex";
    }
    function closeModal() {
      modal.style.display = "none";
    }

    document.addEventListener("keydown", function(e) {
  if (e.key === "F12" || 
      (e.ctrlKey && e.shiftKey && (e.key === "I" || e.key === "J")) || 
      (e.ctrlKey && e.key === "U")) {
    e.preventDefault();
    alert("アクセス拒否：不正操作を検知しました");
  }
});

 document.addEventListener("contextmenu", e => e.preventDefault());

  </script>
</body>
</html>
